import{A as ue}from"./AppLayout-CD1ADZOp.js";import{S as me}from"./StatCard-BUPjxBlf.js";import{p as he,s as fe,x as M,g as pe,I as _e,d as z,y as ve,z as be,b as e,A as x,F as Z,o as m,c as b,w as l,m as q,a as r,i as n,t as d,l as H,f as _,h as S,j as Ve}from"./app-BD53c_6I.js";import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{d as ye,c as ke,a as R,V as c,b as U}from"./VMain-CyvN97go.js";import{V}from"./VSpacer-wU3il1dN.js";import{V as O}from"./VDialog-WRqlUehj.js";import{V as W}from"./VForm-D_52LBJB.js";import{V as f,a as G,b as J}from"./VCard-FbPoq3pi.js";import{m as Ce,u as Be,a as K,V as w}from"./VTextField-B720HIDV.js";import{a as g,V as Q}from"./VRow-CqzdvEiR.js";import{c as Se,u as we,b as Fe,V as F,L as xe,d as Ae}from"./index-CrjpEtVr.js";import{a as De,b as X}from"./VCheckboxBtn-DFeMpP_V.js";import{f as je,V as Y}from"./VDataTable-DsklF7e2.js";import"./VAvatar-NvWIg0QJ.js";import"./easing-DY7PVvcf.js";import"./forwardRefs-C-GTDzx5.js";import"./form-DsKgHv_O.js";const Pe=he({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...Ce(),...De()},"VSwitch"),Te=fe()({name:"VSwitch",inheritAttrs:!1,props:Pe(),emits:{"update:focused":t=>!0,"update:modelValue":t=>!0,"update:indeterminate":t=>!0},setup(t,o){let{attrs:I,slots:u}=o;const a=M(t,"indeterminate"),i=M(t,"modelValue"),{loaderClasses:y}=Se(t),{isFocused:A,focus:s,blur:p}=Be(t),N=pe(),E=_e&&window.matchMedia("(forced-colors: active)").matches,$=z(()=>typeof t.loading=="string"&&t.loading!==""?t.loading:t.color),ee=ve(),te=z(()=>t.id||`switch-${ee}`);function le(){a.value&&(a.value=!1)}function ae(k){var C,B;k.stopPropagation(),k.preventDefault(),(B=(C=N.value)==null?void 0:C.input)==null||B.click()}return we(()=>{const[k,C]=be(I),B=K.filterProps(t),se=X.filterProps(t);return e(K,x({class:["v-switch",{"v-switch--flat":t.flat},{"v-switch--inset":t.inset},{"v-switch--indeterminate":a.value},y.value,t.class]},k,B,{modelValue:i.value,"onUpdate:modelValue":D=>i.value=D,id:te.value,focused:A.value,style:t.style}),{...u,default:D=>{let{id:oe,messagesId:re,isDisabled:ne,isReadonly:ie,isValid:L}=D;const j={model:i,isValid:L};return e(X,x({ref:N},se,{modelValue:i.value,"onUpdate:modelValue":[v=>i.value=v,le],id:oe.value,"aria-describedby":re.value,type:"checkbox","aria-checked":a.value?"mixed":void 0,disabled:ne.value,readonly:ie.value,onFocus:s,onBlur:p},C),{...u,default:v=>{let{backgroundColorClasses:P,backgroundColorStyles:h}=v;return e("div",{class:["v-switch__track",E?void 0:P.value],style:h.value,onClick:ae},[u["track-true"]&&e("div",{key:"prepend",class:"v-switch__track-true"},[u["track-true"](j)]),u["track-false"]&&e("div",{key:"append",class:"v-switch__track-false"},[u["track-false"](j)])])},input:v=>{let{inputNode:P,icon:h,backgroundColorClasses:ce,backgroundColorStyles:de}=v;return e(Z,null,[P,e("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":h||t.loading},t.inset||E?void 0:ce.value],style:t.inset?void 0:de.value},[u.thumb?e(Fe,{defaults:{VIcon:{icon:h,size:"x-small"}}},{default:()=>[u.thumb({...j,icon:h})]}):e(ye,null,{default:()=>[t.loading?e(xe,{name:"v-switch",active:!0,color:L.value===!1?void 0:$.value},{default:T=>u.loader?u.loader(T):e(ke,{active:T.isActive,color:T.color,indeterminate:!0,size:"16",width:"2"},null)}):h&&e(F,{key:String(h),icon:h,size:"x-small"},null)]})])])}})}})}),{}}}),Re={components:{StatCard:me,AppLayout:ue},data(){return{headers:[{title:"ID",key:"id"},{title:"Client",key:"client.full_name"},{title:"Stand No",key:"stand.stand_number"},{title:"Batch No",key:"batch"},{title:"More",key:"actions",sortable:!1}],batchesHeaders:[{title:"ID",key:"id"},{title:"Batch Name",key:"name"},{title:"More",key:"actions",sortable:!1}],search:"",showActive:!0,showCancelled:!1,showBatch:!1,items:[],title:"Active Contracts",batchForm:this.$inertia.form({project_id:this.$page.props.project.id,id:null,name:""}),dialogBatch:!1,selectedBatch:!1,dialogSelectedBatch:!1,batchSelectedForm:this.$inertia.form({id:null,project_id:this.$page.props.project.id,batch_id:null,start_date:null,end_date:null,installment_amount:null,calculate_penalty:1,calculate_penalty_after:10})}},methods:{makeCancelledVisible(){this.showCancelled=!0,this.showActive=!1,this.showBatch=!1,this.items=this.$page.props.project.cancelled,this.title="Cancelled Contracts"},makeActiveVisible(){this.showCancelled=!1,this.showActive=!0,this.showBatch=!1,this.items=this.$page.props.project.active,this.title="Active Contracts"},makeBatchVisible(){this.showCancelled=!1,this.showActive=!1,this.showBatch=!0,this.title="All Project Batches"},addBatch(){this.batchForm.post(route("admin.batch.store"),{onSuccess:()=>{this.batchForm.reset(),this.dialogBatch=!1}})},editBatch(t){this.batchForm.id=t.id,this.batchForm.project_id=t.project_id,this.batchForm.name=t.name,this.dialogBatch=!0},deleteBatch(t){this.$swal.fire({title:"Are you sure?",icon:"question",showDenyButton:!0,confirmButtonText:"Delete",denyButtonText:"Cancel"}).then(o=>{o.isConfirmed&&this.$inertia.visit(route("admin.batch.destroy",t),{method:"delete"})})},selectBatch(t){this.selectedBatch=t,this.batchSelectedForm.batch_id=t.id},addBatchRule(){this.batchSelectedForm.post(route("admin.batch-rules.store"),{onSuccess:()=>{this.batchSelectedForm.reset(),this.dialogSelectedBatch=!1}})},editRule(t){this.batchSelectedForm.id=t.id,this.batchSelectedForm.project_id=t.project_id,this.batchSelectedForm.start_date=t.start_date,this.batchSelectedForm.end_date=t.end_date,this.batchSelectedForm.installment_amount=t.installment_amount,this.batchSelectedForm.calculate_penalty=t.calculate_penalty,this.batchSelectedForm.calculate_penalty_after=t.calculate_penalty_after,this.dialogSelectedBatch=!0},deleteRule(t){this.$swal.fire({title:"Are you sure?",icon:"question",showDenyButton:!0,confirmButtonText:"Delete",denyButtonText:"Cancel"}).then(o=>{o.isConfirmed&&this.$inertia.visit(route("admin.batch-rules.destroy",t),{method:"delete"})})}}},Ue={class:"glass pa-3"},Ie={class:"d-flex align-center"},Ne={style:{width:"80%"},class:"pa-3 mt-n5"},Ee={class:"ml-3 mt-2"},Le={class:"d-flex align-center"},Me={style:{width:"80%"},class:"pa-3 mt-n5"},ze={class:"ml-3 mt-2"},qe={class:"d-flex align-center"},He={style:{width:"80%"},class:"pa-3 mt-n5"},Oe={class:"ml-3 mt-2"},We={key:0},Ge={key:0},Je=r("label",{for:"start_date"},"Select Start Date",-1),Ke=r("br",null,null,-1),Qe={key:0,class:"_12px",style:{color:"red"}},Xe=r("label",{for:"start_date"},"Select End Date",-1),Ye=r("br",null,null,-1),Ze={key:0,class:"_12px",style:{color:"red"}},$e=r("thead",null,[r("tr",null,[r("th",{class:"text-left"},"Start Date "),r("th",{class:"text-left"},"End Date "),r("th",{class:"text-left"},"Installment "),r("th",{class:"text-left"},"Penalty Day "),r("th",null,"More")])],-1),et={class:"d-flex"},tt={class:"d-flex"};function lt(t,o,I,u,a,i){const y=q("DatePickerEs"),A=q("AppLayout");return m(),b(A,null,{default:l(()=>[r("div",Ue,[e(U,{class:"rounded-lg px-2 mb-5",density:"comfortable"},{default:l(()=>[e(R,null,{default:l(()=>[n(d(t.$page.props.project.name),1)]),_:1}),e(V),e(O,{persistent:"","max-width":"500",modelValue:a.dialogBatch,"onUpdate:modelValue":o[2]||(o[2]=s=>a.dialogBatch=s)},{activator:l(({props:s})=>[e(c,x(s,{text:"Add Batch",variant:"flat"}),null,16)]),default:l(()=>[e(W,{onSubmit:H(i.addBatch,["prevent"])},{default:l(()=>[e(f,{title:"Add Batch"},{default:l(()=>[e(G,null,{default:l(()=>[e(w,{label:"Batch Name",modelValue:a.batchForm.name,"onUpdate:modelValue":o[0]||(o[0]=s=>a.batchForm.name=s)},null,8,["modelValue"])]),_:1}),e(J,null,{default:l(()=>[e(V),e(c,{text:"Cancel",color:"warning",onClick:o[1]||(o[1]=s=>a.dialogBatch=!1)}),e(c,{variant:"flat",loading:a.batchForm.processing,text:"Submit Details",type:"submit"},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])]),_:1}),e(Q,{class:"mt-3"},{default:l(()=>[e(g,{cols:"4"},{default:l(()=>[e(f,{onClick:i.makeActiveVisible,variant:"flat",class:"cursor-pointer glass cursor-hand rounded-lg mb-5"},{default:l(()=>[r("div",Ie,[r("div",Ne,[r("h1",Ee,d(t.$page.props.project.active.length),1),n(" Active Contracts ")]),e(f,{color:"success",class:"mt-n1 pa-3",elevation:"12"},{default:l(()=>[e(F,null,{default:l(()=>[n("mdi-file-document-edit")]),_:1})]),_:1})])]),_:1},8,["onClick"])]),_:1}),e(g,{cols:"4"},{default:l(()=>[e(f,{onClick:i.makeCancelledVisible,variant:"flat",class:"cursor-pointer glass cursor-hand rounded-lg mb-5"},{default:l(()=>[r("div",Le,[r("div",Me,[r("h1",ze,d(t.$page.props.project.cancelled.length),1),n(" Cancelled Contracts ")]),e(f,{color:"error",class:"mt-n1 pa-3",elevation:"12"},{default:l(()=>[e(F,null,{default:l(()=>[n("mdi-account-cancel")]),_:1})]),_:1})])]),_:1},8,["onClick"])]),_:1}),e(g,{cols:"4"},{default:l(()=>[e(f,{onClick:i.makeBatchVisible,variant:"flat",class:"cursor-pointer glass cursor-hand rounded-lg mb-5"},{default:l(()=>[r("div",qe,[r("div",He,[r("h1",Oe,d(t.$page.props.project.batches.length),1),n(" Batches ")]),e(f,{color:"error",class:"mt-n1 pa-3",elevation:"12"},{default:l(()=>[e(F,null,{default:l(()=>[n("mdi-account-cancel")]),_:1})]),_:1})])]),_:1},8,["onClick"])]),_:1})]),_:1}),e(U,{class:"my-3 rounded-lg bg-white"},{default:l(()=>[e(R,null,{default:l(()=>[n(d(a.title),1)]),_:1}),e(V),e(Ae,{"max-width":"350px"},{default:l(()=>[e(w,{modelValue:a.search,"onUpdate:modelValue":o[3]||(o[3]=s=>a.search=s),"hide-details":"",variant:"solo",density:"compact",class:"mr-3",placeholder:"Search...","prepend-inner-icon":"mdi-magnify",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),a.showBatch?(m(),_("div",We,[a.selectedBatch?(m(),_("div",Ge,[e(U,{class:"rounded-lg px-2 mb-5",density:"comfortable"},{default:l(()=>[e(R,null,{default:l(()=>[n(d(t.$page.props.project.name)+" | "+d(a.selectedBatch.name),1)]),_:1}),e(V),e(c,{onClick:o[4]||(o[4]=s=>a.selectedBatch=null)},{default:l(()=>[n(" Back to Batch List ")]),_:1}),e(O,{persistent:"","max-width":"600",modelValue:a.dialogSelectedBatch,"onUpdate:modelValue":o[13]||(o[13]=s=>a.dialogSelectedBatch=s)},{activator:l(({props:s})=>[e(c,x(s,{text:"Add Batch Rules",variant:"flat"}),null,16)]),default:l(()=>[e(W,{onSubmit:H(i.addBatchRule,["prevent"])},{default:l(()=>[e(f,{title:"Add Batch"},{default:l(()=>[e(G,null,{default:l(()=>[e(Q,{class:"mb-3"},{default:l(()=>[e(g,{cols:"12",md:"6"},{default:l(()=>[Je,n(),Ke,e(y,{modelValue:a.batchSelectedForm.start_date,"onUpdate:modelValue":o[5]||(o[5]=s=>a.batchSelectedForm.start_date=s),valueType:"format",value:a.batchSelectedForm.start_date,"onUpdate:value":o[6]||(o[6]=s=>a.batchSelectedForm.start_date=s)},null,8,["modelValue","value"]),t.$page.props.errors.start_date?(m(),_("span",Qe,d(t.$page.props.errors.start_date),1)):S("",!0)]),_:1}),e(g,{cols:"12",md:"6"},{default:l(()=>[Xe,n(),Ye,e(y,{modelValue:a.batchSelectedForm.end_date,"onUpdate:modelValue":o[7]||(o[7]=s=>a.batchSelectedForm.end_date=s),valueType:"format",value:a.batchSelectedForm.end_date,"onUpdate:value":o[8]||(o[8]=s=>a.batchSelectedForm.end_date=s)},null,8,["modelValue","value"]),t.$page.props.errors.end_date?(m(),_("span",Ze,d(t.$page.props.errors.end_date),1)):S("",!0)]),_:1})]),_:1}),e(w,{label:"Installment Amount",modelValue:a.batchSelectedForm.installment_amount,"onUpdate:modelValue":o[9]||(o[9]=s=>a.batchSelectedForm.installment_amount=s),"error-messages":t.$page.props.errors.installment_amount},null,8,["modelValue","error-messages"]),e(w,{class:"mt-5",label:"Calculate Penalty After",modelValue:a.batchSelectedForm.calculate_penalty_after,"onUpdate:modelValue":o[10]||(o[10]=s=>a.batchSelectedForm.calculate_penalty_after=s),"error-messages":t.$page.props.errors.calculate_penalty_after,hint:"Enter day of month. eg every 10th","persistent-hint":""},null,8,["modelValue","error-messages"]),e(Te,{"true-value":1,"false-value":0,color:"primary",class:"mt-5",label:"Calculate Penalty for this Period?",inset:"",modelValue:a.batchSelectedForm.calculate_penalty,"onUpdate:modelValue":o[11]||(o[11]=s=>a.batchSelectedForm.calculate_penalty=s)},null,8,["modelValue"])]),_:1}),e(J,null,{default:l(()=>[e(V),e(c,{text:"Cancel",color:"warning",variant:"flat",onClick:o[12]||(o[12]=s=>a.dialogSelectedBatch=!1)}),e(c,{variant:"flat",loading:a.batchSelectedForm.processing,text:"Submit Rule Details",type:"submit"},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])]),_:1}),e(je,null,{default:l(()=>[$e,r("tbody",null,[(m(!0),_(Z,null,Ve(a.selectedBatch.rules,s=>(m(),_("tr",{key:s.id},[r("td",null,d(s.start_date),1),r("td",null,d(s.end_date),1),r("td",null,d(s.installment_amount),1),r("td",null,d(s.calculate_penalty_after),1),r("td",null,[e(c,{onClick:p=>i.editRule(s),class:"mx-1",color:"success"},{default:l(()=>[n("View")]),_:2},1032,["onClick"]),e(c,{onClick:p=>i.deleteRule(s),color:"error",class:"mx-1"},{default:l(()=>[n(" Delete ")]),_:2},1032,["onClick"])])]))),128))])]),_:1})])):(m(),b(Y,{key:1,items:t.$page.props.project.batches,headers:a.batchesHeaders},{"item.actions":l(({item:s})=>[r("div",et,[e(c,{onClick:p=>i.selectBatch(s),class:"mx-1",color:"success"},{default:l(()=>[n("View")]),_:2},1032,["onClick"]),e(c,{onClick:p=>i.editBatch(s),class:"mx-1",color:"primary"},{default:l(()=>[n("Edit")]),_:2},1032,["onClick"]),e(c,{onClick:p=>i.deleteBatch(s),color:"error",class:"mx-1"},{default:l(()=>[n(" Delete ")]),_:2},1032,["onClick"])])]),_:1},8,["items","headers"]))])):(m(),b(Y,{key:1,items:a.items,headers:a.headers,search:a.search},{"item.actions":l(({item:s})=>[r("div",tt,[e(c,{class:"mx-1",color:"success"},{default:l(()=>[n("View")]),_:1}),a.showActive?(m(),b(c,{key:0,color:"error",class:"mx-1"},{default:l(()=>[n(" Cancel ")]),_:1})):S("",!0),a.showCancelled?(m(),b(c,{key:1,color:"primary",class:"mx-1"},{default:l(()=>[n(" Restore ")]),_:1})):S("",!0)])]),_:1},8,["items","headers","search"]))])]),_:1})}const yt=ge(Re,[["render",lt]]);export{yt as default};
