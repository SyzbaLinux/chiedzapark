import{u as De,V as Ae,a as Pe,b as te,A as Fe,c as Re}from"./AppLayout-CD1ADZOp.js";import{D as Ie}from"./index-B8Xfj6z_.js";import{_ as Te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as Ue,V as P,b as Be,c as Me}from"./VMain-CyvN97go.js";import{V as Ee}from"./VSpacer-wU3il1dN.js";import{b as Le,V as B}from"./VTextField-B720HIDV.js";import{V as Ne,c as Oe,a as je,b as Ke}from"./VCard-FbPoq3pi.js";import{V as qe,a as F}from"./VRow-CqzdvEiR.js";import{m as ze,b as He,u as Ge,c as Je,d as We,e as Qe,a as Xe,V as Ye}from"./VDataTable-DsklF7e2.js";import{m as Ze,a as $e,u as el,V as Y,b as ll}from"./index-CrjpEtVr.js";import{u as tl}from"./form-DsKgHv_O.js";import{f as al}from"./forwardRefs-C-GTDzx5.js";import{p as nl,q as ol,s as ul,C as sl,g as j,D as U,x as X,d as y,E as K,B as ae,I as rl,b as t,F as q,A as R,G as il,i as k,H as cl,J as ne,K as dl,o as oe,c as ml,w as c,m as ue,a as w,t as se,f as fl,h as vl}from"./app-BD53c_6I.js";import{V as pl}from"./VCheckboxBtn-DFeMpP_V.js";import{V as gl}from"./VAvatar-NvWIg0QJ.js";import{V as _l}from"./VTextarea-Duv_Jilb.js";import{V as hl}from"./VDialog-WRqlUehj.js";import"./easing-DY7PVvcf.js";function Vl(e,n,u){if(n==null)return e;if(Array.isArray(n))throw new Error("Multiple matches is not implemented");return typeof n=="number"&&~n?t(q,null,[t("span",{class:"v-autocomplete__unmask"},[e.substr(0,n)]),t("span",{class:"v-autocomplete__mask"},[e.substr(n,u)]),t("span",{class:"v-autocomplete__unmask"},[e.substr(n+u)])]):e}const Cl=nl({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...ze({filterKeys:["title"]}),...He(),...ol(Le({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...Ze({transition:!1})},"VAutocomplete"),bl=ul()({name:"VAutocomplete",props:Cl(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,n){let{slots:u}=n;const{t:M}=sl(),a=j(),h=U(!1),b=U(!0),I=U(!1),i=j(),E=j(),z=X(e,"menu"),v=y({get:()=>z.value,set:l=>{var o;z.value&&!l&&((o=i.value)!=null&&o.Î¨openChildren)||(z.value=l)}}),f=U(-1),re=y(()=>{var l;return(l=a.value)==null?void 0:l.color}),Z=y(()=>v.value?e.closeText:e.openText),{items:$,transformIn:ie,transformOut:ce}=De(e),{textColorClasses:de,textColorStyles:me}=$e(re),p=X(e,"search",""),r=X(e,"modelValue",[],l=>ie(l===null?[null]:dl(l)),l=>{const o=ce(l);return e.multiple?o:o[0]??null}),fe=y(()=>typeof e.counterValue=="function"?e.counterValue(r.value):typeof e.counterValue=="number"?e.counterValue:r.value.length),A=tl(),{filteredItems:H,getMatches:ve}=Ge(e,$,()=>b.value?"":p.value),S=y(()=>e.hideSelected?H.value.filter(l=>!r.value.some(o=>o.value===l.value)):H.value),L=y(()=>!!(e.chips||u.chip)),T=y(()=>L.value||!!u.selection),pe=y(()=>r.value.map(l=>l.props.value)),G=y(()=>{var o;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&p.value===((o=S.value[0])==null?void 0:o.title))&&S.value.length>0&&!b.value&&!I.value}),J=y(()=>e.hideNoData&&!S.value.length||e.readonly||(A==null?void 0:A.isReadonly.value)),W=j(),{onListScroll:ge,onListKeydown:_e}=Je(W,a);function he(l){e.openOnClear&&(v.value=!0),p.value=""}function Ve(){J.value||(v.value=!0)}function Ce(l){J.value||(h.value&&(l.preventDefault(),l.stopPropagation()),v.value=!v.value)}function be(l){var s,d,V;if(e.readonly||A!=null&&A.isReadonly.value)return;const o=a.value.selectionStart,m=r.value.length;if((f.value>-1||["Enter","ArrowDown","ArrowUp"].includes(l.key))&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(v.value=!0),["Escape"].includes(l.key)&&(v.value=!1),G.value&&["Enter","Tab"].includes(l.key)&&!r.value.some(g=>{let{value:_}=g;return _===S.value[0].value})&&x(S.value[0]),l.key==="ArrowDown"&&G.value&&((s=W.value)==null||s.focus("next")),["Backspace","Delete"].includes(l.key)){if(!e.multiple&&T.value&&r.value.length>0&&!p.value)return x(r.value[0],!1);if(~f.value){const g=f.value;x(r.value[f.value],!1),f.value=g>=m-1?m-2:g}else l.key==="Backspace"&&!p.value&&(f.value=m-1)}if(e.multiple){if(l.key==="ArrowLeft"){if(f.value<0&&o>0)return;const g=f.value>-1?f.value-1:m-1;r.value[g]?f.value=g:(f.value=-1,a.value.setSelectionRange((d=p.value)==null?void 0:d.length,(V=p.value)==null?void 0:V.length))}if(l.key==="ArrowRight"){if(f.value<0)return;const g=f.value+1;r.value[g]?f.value=g:(f.value=-1,a.value.setSelectionRange(0,0))}}}function ye(l){if(ne(a.value,":autofill")||ne(a.value,":-webkit-autofill")){const o=$.value.find(m=>m.title===l.target.value);o&&x(o)}}function ke(){var l;h.value&&(b.value=!0,(l=a.value)==null||l.focus())}function we(l){h.value=!0,setTimeout(()=>{I.value=!0})}function Se(l){I.value=!1}function xe(l){(l==null||l===""&&!e.multiple&&!T.value)&&(r.value=[])}const Q=U(!1);function x(l){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!l||l.props.disabled))if(e.multiple){const m=r.value.findIndex(d=>e.valueComparator(d.value,l.value)),s=o??!~m;if(~m){const d=s?[...r.value,l]:[...r.value];d.splice(m,1),r.value=d}else s&&(r.value=[...r.value,l]);e.clearOnSelect&&(p.value="")}else{const m=o!==!1;r.value=m?[l]:[],p.value=m&&!T.value?l.title:"",ae(()=>{v.value=!1,b.value=!0})}}return K(h,(l,o)=>{var m;l!==o&&(l?(Q.value=!0,p.value=e.multiple||T.value?"":String(((m=r.value.at(-1))==null?void 0:m.props.title)??""),b.value=!0,ae(()=>Q.value=!1)):(!e.multiple&&p.value==null&&(r.value=[]),v.value=!1,r.value.some(s=>{let{title:d}=s;return d===p.value})||(p.value=""),f.value=-1))}),K(p,l=>{!h.value||Q.value||(l&&(v.value=!0),b.value=!l)}),K(v,()=>{if(!e.hideSelected&&v.value&&r.value.length){const l=S.value.findIndex(o=>r.value.some(m=>o.value===m.value));rl&&window.requestAnimationFrame(()=>{var o;l>=0&&((o=E.value)==null||o.scrollToIndex(l))})}}),K(()=>e.items,(l,o)=>{v.value||h.value&&!o.length&&l.length&&(v.value=!0)}),el(()=>{const l=!!(!e.hideNoData||S.value.length||u["prepend-item"]||u["append-item"]||u["no-data"]),o=r.value.length>0,m=B.filterProps(e);return t(B,R({ref:a},m,{modelValue:p.value,"onUpdate:modelValue":[s=>p.value=s,xe],focused:h.value,"onUpdate:focused":s=>h.value=s,validationValue:r.externalValue,counterValue:fe.value,dirty:o,onChange:ye,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":v.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!T.value,"v-autocomplete--selecting-index":f.value>-1},e.class],style:e.style,readonly:e.readonly,placeholder:o?void 0:e.placeholder,"onClick:clear":he,"onMousedown:control":Ve,onKeydown:be}),{...u,default:()=>t(q,null,[t(Ae,R({ref:i,modelValue:v.value,"onUpdate:modelValue":s=>v.value=s,activator:"parent",contentClass:"v-autocomplete__content",disabled:J.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:ke},e.menuProps),{default:()=>[l&&t(Pe,R({ref:W,selected:pe.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:s=>s.preventDefault(),onKeydown:_e,onFocusin:we,onFocusout:Se,onScrollPassive:ge,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},e.listProps),{default:()=>{var s,d,V;return[(s=u["prepend-item"])==null?void 0:s.call(u),!S.value.length&&!e.hideNoData&&(((d=u["no-data"])==null?void 0:d.call(u))??t(te,{title:M(e.noDataText)},null)),t(We,{ref:E,renderless:!0,items:S.value},{default:g=>{var le;let{item:_,index:D,itemRef:C}=g;const ee=R(_.props,{ref:C,key:D,active:G.value&&D===0?!0:void 0,onClick:()=>x(_,null)});return((le=u.item)==null?void 0:le.call(u,{item:_,index:D,props:ee}))??t(te,R(ee,{role:"option"}),{prepend:N=>{let{isSelected:O}=N;return t(q,null,[e.multiple&&!e.hideSelected?t(pl,{key:_.value,modelValue:O,ripple:!1,tabindex:"-1"},null):void 0,_.props.prependAvatar&&t(gl,{image:_.props.prependAvatar},null),_.props.prependIcon&&t(Y,{icon:_.props.prependIcon},null)])},title:()=>{var N,O;return b.value?_.title:Vl(_.title,(N=ve(_))==null?void 0:N.title,((O=p.value)==null?void 0:O.length)??0)}})}}),(V=u["append-item"])==null?void 0:V.call(u)]}})]}),r.value.map((s,d)=>{function V(C){C.stopPropagation(),C.preventDefault(),x(s,!1)}const g={"onClick:close":V,onKeydown(C){C.key!=="Enter"&&C.key!==" "||(C.preventDefault(),C.stopPropagation(),V(C))},onMousedown(C){C.preventDefault(),C.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},_=L.value?!!u.chip:!!u.selection,D=_?il(L.value?u.chip({item:s,index:d,props:g}):u.selection({item:s,index:d})):void 0;if(!(_&&!D))return t("div",{key:s.value,class:["v-autocomplete__selection",d===f.value&&["v-autocomplete__selection--selected",de.value]],style:d===f.value?me.value:{}},[L.value?u.chip?t(ll,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:s.title}}},{default:()=>[D]}):t(Qe,R({key:"chip",closable:e.closableChips,size:"small",text:s.title,disabled:s.props.disabled},g),null):D??t("span",{class:"v-autocomplete__selection-text"},[s.title,e.multiple&&d<r.value.length-1&&t("span",{class:"v-autocomplete__selection-comma"},[k(",")])])])})]),"append-inner":function(){var g;for(var s=arguments.length,d=new Array(s),V=0;V<s;V++)d[V]=arguments[V];return t(q,null,[(g=u["append-inner"])==null?void 0:g.call(u,...d),e.menuIcon?t(Y,{class:"v-autocomplete__menu-icon",icon:e.menuIcon,onMousedown:Ce,onClick:cl,"aria-label":M(Z.value),title:M(Z.value),tabindex:"-1"},null):void 0])}})}),al({isFocused:h,isPristine:b,menu:v,search:p,filteredItems:H,select:x},a)}}),yl={components:{DatePicker:Ie,AppLayout:Fe},data(){return{form:this.$inertia.form({id:null,client_id:null,receipt_date:null,agreement_of_sale_id:null,receipt_number:null,amount_paid:null,description:null}),headers:[{title:"ID",key:"id"},{title:"Client",key:"client.fullname"},{title:"Date paid",key:"receipt_date"},{title:"Contract",key:"agreement_of_sale_id"},{title:"Receipt No",key:"receipt_number"},{title:"Actions",key:"actions",sortable:!1}],search:"",dialog:!1,clientRules:[e=>!!e||"Please Select a Client"],contractRules:[e=>!!e||"Client Contract is required"],dateRules:[e=>!!e||"Date paid is required"],amountRules:[e=>!!e||"Amount paid is required"],clientContracts:[],gettingContracts:!1}},methods:{submitForm(){this.form.post(route("admin.payments.store"),{onSuccess:()=>{this.closeDialog()}})},closeDialog(){this.dialog=!1,this.form.reset()},editSubject(e){this.form.id=e.id,this.form.project_id=e.project_id,this.form.client_id=e.client_id,this.form.receipt_date=e.receipt_date,this.form.agreement_of_sale_id=e.agreement_of_sale_id,this.form.stand_number=e.stand_number,this.form.receipt_number=e.receipt_number,this.form.amount_paid=e.amount_paid,this.form.description=e.description,this.form.payment_method=e.payment_method,this.form.currency=e.currency,this.form.amount_in_words=e.amount_in_words,this.dialog=!0},deleteSubject(e){this.$swal.fire({title:"Are you sure?",icon:"question",showDenyButton:!0,confirmButtonText:"Delete",denyButtonText:"Cancel"}).then(n=>{n.isConfirmed&&this.$inertia.visit(route("admin.payments.destroy",e),{method:"delete"})})},getClientContracts(){this.form.client_id&&(this.gettingContracts=!0,axios.get(route("admin.clientContracts",this.form.client_id)).then(e=>{this.clientContracts=e.data,this.gettingContracts=!1}))}}},kl={class:"glass pa-3"},wl=w("label",{for:"start_date"},"Select Date Paid",-1),Sl=w("br",null,null,-1),xl={key:0,class:"_12px",style:{color:"red"}},Dl=w("br",null,null,-1),Al=w("br",null,null,-1),Pl=w("br",null,null,-1),Fl={class:"d-flex"},Rl={class:"text-center"},Il=w("br",null,null,-1),Tl=w("span",{class:"text-white"}," Please wait... while we fetch client contracts ",-1);function Ul(e,n,u,M,a,h){const b=ue("DatePickerEs"),I=ue("AppLayout");return oe(),ml(I,{title:"All Payments"},{default:c(()=>[w("div",kl,[t(Be,{class:"rounded-lg px-2 mb-5",density:"comfortable"},{default:c(()=>[t(Ue,null,{default:c(()=>[k(" All Payments ("+se(e.$page.props.payments.length)+") ",1)]),_:1}),t(Ee),t(B,{modelValue:a.search,"onUpdate:modelValue":n[0]||(n[0]=i=>a.search=i),"hide-details":"",variant:"solo",density:"compact",class:"mr-3",placeholder:"Search...","prepend-inner-icon":"mdi-magnify"},null,8,["modelValue"]),t(P,{onClick:n[1]||(n[1]=i=>a.dialog=!0),variant:"flat"},{default:c(()=>[k(" Add Payment ")]),_:1})]),_:1}),t(hl,{"max-width":"700",modelValue:a.dialog,"onUpdate:modelValue":n[10]||(n[10]=i=>a.dialog=i),persistent:""},{default:c(()=>[t(Ne,{variant:"flat"},{default:c(()=>[t(Oe,{class:"my-3"},{default:c(()=>[k("Payment Information Form")]),_:1}),t(je,null,{default:c(()=>[t(qe,null,{default:c(()=>[t(F,{cols:"12",md:"6"},{default:c(()=>[t(bl,{clearable:"",modelValue:a.form.client_id,"onUpdate:modelValue":[n[2]||(n[2]=i=>a.form.client_id=i),n[3]||(n[3]=i=>h.getClientContracts())],label:"Select Client Name","prepend-inner-icon":"mdi-account-group",items:e.$page.props.clients,"item-title":"fullname","item-value":"id",rules:a.clientRules,"error-messages":e.$page.props.errors.client_id},null,8,["modelValue","items","rules","error-messages"])]),_:1}),t(F,{cols:"12",md:"6"},{default:c(()=>[t(Xe,{disabled:a.gettingContracts,modelValue:a.form.agreement_of_sale_id,"onUpdate:modelValue":n[4]||(n[4]=i=>a.form.agreement_of_sale_id=i),label:"Please Select Client Contract","prepend-inner-icon":"mdi-book",items:a.clientContracts,"error-messages":e.$page.props.errors.agreement_of_sale_id},null,8,["disabled","modelValue","items","error-messages"])]),_:1}),t(F,{cols:"12",md:"6"},{default:c(()=>[wl,k(),Sl,t(b,{modelValue:a.form.receipt_date,"onUpdate:modelValue":n[5]||(n[5]=i=>a.form.receipt_date=i),valueType:"format",value:a.form.receipt_date,"onUpdate:value":n[6]||(n[6]=i=>a.form.receipt_date=i)},null,8,["modelValue","value"]),e.$page.props.errors.receipt_date?(oe(),fl("span",xl,se(e.$page.props.errors.receipt_date),1)):vl("",!0)]),_:1}),t(F,{cols:"12",md:"6"},{default:c(()=>[Dl,t(B,{modelValue:a.form.receipt_number,"onUpdate:modelValue":n[7]||(n[7]=i=>a.form.receipt_number=i),label:"Receipt No","prepend-inner-icon":"mdi-book","error-messages":e.$page.props.errors.receipt_number},null,8,["modelValue","error-messages"])]),_:1}),t(F,{cols:"12",md:"6"},{default:c(()=>[Al,t(B,{type:"number",modelValue:a.form.amount_paid,"onUpdate:modelValue":n[8]||(n[8]=i=>a.form.amount_paid=i),label:"Amount Paid","prepend-inner-icon":"mdi-book",rules:a.amountRules,"error-messages":e.$page.props.errors.amount_paid},null,8,["modelValue","rules","error-messages"])]),_:1}),t(F,{cols:"12",md:"6"},{default:c(()=>[Pl,t(_l,{rows:"3",modelValue:a.form.description,"onUpdate:modelValue":n[9]||(n[9]=i=>a.form.description=i),label:"Additional Details","prepend-inner-icon":"mdi-book","error-messages":e.$page.props.errors.description},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),t(Ke,{class:"mt-n5"},{default:c(()=>[t(P,{class:"mx-1",variant:"flat",color:"warning",onClick:h.closeDialog},{default:c(()=>[k("Cancel")]),_:1},8,["onClick"]),t(P,{variant:"flat",class:"mx-1",color:"primary",onClick:h.submitForm,loading:a.form.processing},{default:c(()=>[k(" Submit ")]),_:1},8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Ye,{items:e.$page.props.payments,headers:a.headers,search:a.search},{"item.actions":c(({item:i})=>[w("div",Fl,[t(P,{class:"mx-1",color:"success"},{default:c(()=>[k("View")]),_:1}),t(P,{class:"mx-1",onClick:E=>h.editSubject(i)},{default:c(()=>[k("Edit")]),_:2},1032,["onClick"]),t(P,{color:"error",class:"mx-1",onClick:E=>h.deleteSubject(i)},{default:c(()=>[t(Y,null,{default:c(()=>[k("mdi-trash-can")]),_:1})]),_:2},1032,["onClick"])])]),_:1},8,["items","headers","search"])]),t(Re,{modelValue:a.gettingContracts,"onUpdate:modelValue":n[11]||(n[11]=i=>a.gettingContracts=i),class:"d-flex align-center justify-center"},{default:c(()=>[w("div",Rl,[t(Me,{color:"white",size:"80",indeterminate:""}),Il,Tl])]),_:1},8,["modelValue"])]),_:1})}const $l=Te(yl,[["render",Ul]]);export{$l as default};
